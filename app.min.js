var http=require("http"),fs=require("fs"),im=require("./imagemagick"),qs=require("querystring");http.createServer(function(c,b){if(c.method=="POST"){var a="";
c.on("data",function(d){a+=d;});c.on("end",function(){var j=qs.parse(a),d=["amarilla.png","aqua.png","morada.png","roja.png"],e=["ema/","ciclista/"],h=d[j.cc],i=e[j.cu],l="type/"+i+h,k='label:"'+j.tx+'"',f="created/"+new Buffer(j.cu+j.cc+k).toString("base64")+".png",g={};
b.writeHead(200,{"Content-Type":"application/json"});im.convert([l,"(","-gravity","center","-pointsize","40","-background","transparent","-font","font.ttf","-fill","#dd61d0","-pointsize","40",k,"-virtual-pixel","transparent","-distort","Arc","30","-geometry","+50-50",")","-composite",f],function(n,m){if(n){throw n;
}console.log("out:",f);g.success=true;g.url=f;b.write(g);b.end();});});}if(c){b.end();}}).listen(3000);